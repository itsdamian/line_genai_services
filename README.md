# Line Bot 微服務架構

這個專案使用微服務架構來實現Line Bot與AI模型(OpenAI, Gemini)的整合，提供文字對話和圖片辨識功能。

## 架構概述

```
                  +----------------+
                  |   API Gateway  |
                  +----------------+
                          |
          +---------------+---------------+
          |               |               |
+-----------------+ +------------+ +----------------+
| 使用者管理服務  | | 對話處理服務| | 圖片處理服務   |
+-----------------+ +------------+ +----------------+
          |               |               |
          +-------+-------+-------+-------+
                  |               |
          +---------------+ +------------+
          |   資料庫服務  | | 快取服務   |
          +---------------+ +------------+
```

## 服務說明

1. **API Gateway**
   - 接收Line Webhook請求
   - 路由請求至適當的微服務
   - 實現基本認證與權限控制

2. **使用者管理服務**
   - 使用者資訊管理
   - 使用者偏好設定
   - 使用權限控制

3. **對話處理服務**
   - 處理文字訊息
   - 與OpenAI API整合
   - 對話上下文管理

4. **圖片處理服務**
   - 處理圖片上傳
   - 與Gemini API整合進行圖片辨識
   - 回傳辨識結果

5. **資料庫服務**
   - 儲存使用者資料
   - 記錄對話歷史
   - 提供資料訪問介面

6. **快取服務**
   - 儲存常用回應
   - 減少API調用次數
   - 提高系統回應速度

## 技術棧

- **框架**: FastAPI
- **ORM**: SQLAlchemy
- **資料驗證**: Pydantic
- **通訊**: RESTful API
- **資料庫**: PostgreSQL
- **快取**: Redis
- **外部API**: Line Messaging API, OpenAI API, Gemini API
- **部署**: Docker, Docker Compose
- **HTTP客戶端**: httpx
- **環境變數**: python-dotenv 